<%- include('partials/header') %>

<section class="success-section">
  <div class="container">
    <div class="success-icon">
      <i class="fas fa-check"></i>
    </div>
    
    <h1 class="success-title">
      Pembayaran <span class="gradient-text">Berhasil!</span>
    </h1>
    <p class="success-subtitle" id="successSubtitle">
      Akses Panel Anda telah aktif
    </p>

    <!-- Access Info -->
    <div class="credentials-card">
      <div class="credentials-header">
        <i class="fas fa-key"></i>
        <span>Data Akses Grup</span>
      </div>
      <div class="credentials-body">
        <div class="credential-item">
          <div class="credential-icon" style="background: rgba(139, 92, 246, 0.1); color: #8b5cf6;">
            <i class="fas fa-id-card"></i>
          </div>
          <div class="credential-info">
            <div class="credential-label">Order ID</div>
            <div class="credential-value" id="orderId">-</div>
          </div>
        </div>

        <div class="credential-item">
          <div class="credential-icon" style="background: rgba(59, 130, 246, 0.1); color: #3b82f6;">
            <i class="fab fa-telegram"></i>
          </div>
          <div class="credential-info">
            <div class="credential-label">Username Telegram</div>
            <div class="credential-value" id="telegramUsername">-</div>
          </div>
        </div>

        <div class="credential-item">
          <div class="credential-icon" style="background: rgba(16, 185, 129, 0.1); color: #10b981;">
            <i class="fas fa-crown"></i>
          </div>
          <div class="credential-info">
            <div class="credential-label">Tipe Akses</div>
            <div class="credential-value" id="accessType">-</div>
          </div>
        </div>

        <div class="credential-item" style="background: rgba(139, 92, 246, 0.05); border: 1px solid rgba(139, 92, 246, 0.2); border-radius: 12px; padding: 16px;">
          <div class="credential-icon" style="background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%); color: white;">
            <i class="fas fa-link"></i>
          </div>
          <div class="credential-info" style="flex-grow: 1;">
            <div class="credential-label" id="groupLabel">Link Grup</div>
            <a href="#" id="groupLink" class="credential-value" style="color: #8b5cf6; font-weight: 600; word-break: break-all;" target="_blank">-</a>
          </div>
        </div>

        <button class="btn btn-secondary btn-block" onclick="copyAccessInfo()" style="margin-top: 8px; background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%); color: white; border: none;">
          <i class="fas fa-copy"></i>
          <span>Copy Semua Info</span>
        </button>
      </div>
    </div>

    <!-- Next Steps -->
    <h3 style="font-size: 1.25rem; margin-bottom: 24px; color: var(--text-secondary);">
      <i class="fas fa-list-check"></i> Langkah Selanjutnya
    </h3>
    
    <div class="next-steps">
      <div class="step-card">
        <div class="step-number" style="background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%);">1</div>
        <h4>Join Grup Telegram</h4>
        <p>Klik link grup di atas atau cek PM dari bot Telegram</p>
      </div>

      <div class="step-card">
        <div class="step-number" style="background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%);">2</div>
        <h4>Verifikasi Akun</h4>
        <p>Kirim bukti pembayaran atau Order ID ke admin grup</p>
      </div>

      <div class="step-card">
        <div class="step-number" style="background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%);">3</div>
        <h4>Mulai Jualan</h4>
        <p>Akses price list dan tools reseller sudah tersedia di grup</p>
      </div>
    </div>

    <!-- Warning -->
    <div class="warning-box" style="background: rgba(139, 92, 246, 0.1); border-color: rgba(139, 92, 246, 0.3);">
      <i class="fas fa-info-circle" style="color: #8b5cf6;"></i>
      <div>
        <strong style="color: #8b5cf6;">Informasi Penting!</strong>
        <p>Link grup juga telah dikirim ke bot Telegram. Screenshot halaman ini sebagai bukti pembayaran.</p>
      </div>
    </div>

    <!-- Actions -->
    <div class="action-buttons">
      <a href="#" id="joinGroupBtn" class="btn btn-primary btn-lg" target="_blank" style="background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%);">
        <i class="fab fa-telegram"></i>
        <span>Join Grup Sekarang</span>
      </a>
      <a href="/panel-products" class="btn btn-secondary btn-lg">
        <i class="fas fa-shopping-cart"></i>
        <span>Beli Lagi</span>
      </a>
    </div>
  </div>
</section>

<script>
  let panelData = null;

  function loadPanelData() {
    const data = sessionStorage.getItem('panelAccessData');
    if (!data) {
      showToast('Data akses tidak ditemukan', 'error');
      setTimeout(() => window.location.href = '/panel-products', 2000);
      return;
    }
    
    panelData = JSON.parse(data);
    
    // Update subtitle dengan tipe akses yang benar
    const typeText = panelData.type === 'reseller' ? 'Reseller' : 'Admin';
    document.getElementById('successSubtitle').textContent = `Akses ${typeText} Panel Anda telah aktif`;
    
    // Update label grup
    document.getElementById('groupLabel').textContent = `Link Grup ${typeText}`;
    
    // Isi data
    document.getElementById('orderId').textContent = panelData.orderId;
    document.getElementById('telegramUsername').textContent = '@' + panelData.telegramUsername;
    document.getElementById('accessType').textContent = panelData.name || (panelData.type === 'reseller' ? 'Reseller Panel' : 'Admin Panel');
    document.getElementById('groupLink').textContent = panelData.groupLink;
    document.getElementById('groupLink').href = panelData.groupLink;
    document.getElementById('joinGroupBtn').href = panelData.groupLink;
    
    // Update step card ketiga sesuai tipe
    const stepCards = document.querySelectorAll('.step-card');
    if (stepCards[2]) {
      const isReseller = panelData.type === 'reseller';
      stepCards[2].querySelector('h4').textContent = isReseller ? 'Mulai Jualan' : 'Manage Panel';
      stepCards[2].querySelector('p').textContent = isReseller 
        ? 'Akses price list dan tools reseller sudah tersedia di grup'
        : 'Akses tools admin dan kontrol penuh panel tersedia di grup';
    }
  }

  async function copyAccessInfo() {
    const typeText = panelData.type === 'reseller' ? 'Reseller' : 'Admin';
    
    const text = `
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     ZAROFFC - ${typeText.toUpperCase()} ACCESS INFO        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Order ID    : ${panelData.orderId}
Username TG : @${panelData.telegramUsername}
Tipe Akses  : ${panelData.name || typeText + ' Panel'}
Link Grup   : ${panelData.groupLink}

âš ï¸  Screenshot halaman ini sebagai bukti!
ğŸ“± Link juga dikirim ke Telegram Anda

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    `.trim();
    
    try {
      await navigator.clipboard.writeText(text);
      showToast('Info berhasil disalin!', 'success');
    } catch (err) {
      showToast('Gagal menyalin data', 'error');
    }
  }

  // Load data saat halaman dimuat
  loadPanelData();
</script>

<%- include('partials/footer') %>
